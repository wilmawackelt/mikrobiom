<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">import { useState, useEffect } from "react";</p>
<p class="p1">import { Input } from "@/components/ui/input";</p>
<p class="p1">import { Badge } from "@/components/ui/badge";</p>
<p class="p1">import { Card, CardContent } from "@/components/ui/card";</p>
<p class="p1">import { X, Sparkles } from "lucide-react";</p>
<p class="p2"><br></p>
<p class="p1">const SUGGESTIONS = [</p>
<p class="p1"><span class="Apple-converted-space">  </span>"Apfel", "Banane", "Karotte", "Brokkoli", "Zucchini", "Spinat", "Kürbis", "Tomate",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"Paprika", "Birne", "Pflaume", "Kiwi", "Mango", "Avocado", "Radieschen", "Sellerie",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"Fenchel", "Erbse", "Mais", "Lauch", "Zwiebel", "Knoblauch", "Rote Bete", "Gurke",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"Chicorée", "Rucola", "Blumenkohl", "Grünkohl", "Bohnen", "Süßkartoffel"</p>
<p class="p1">];</p>
<p class="p2"><br></p>
<p class="p1">function getWeekRangeFromDate(date: Date) {</p>
<p class="p1"><span class="Apple-converted-space">  </span>const day = date.getDay();</p>
<p class="p1"><span class="Apple-converted-space">  </span>const diffToMonday = day === 0 ? -6 : 1 - day;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const monday = new Date(date);</p>
<p class="p1"><span class="Apple-converted-space">  </span>monday.setDate(date.getDate() + diffToMonday);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const sunday = new Date(monday);</p>
<p class="p1"><span class="Apple-converted-space">  </span>sunday.setDate(monday.getDate() + 6);</p>
<p class="p1"><span class="Apple-converted-space">  </span>return {</p>
<p class="p1"><span class="Apple-converted-space">    </span>start: monday,</p>
<p class="p1"><span class="Apple-converted-space">    </span>end: sunday</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function getCalendarWeek(date: Date) {</p>
<p class="p1"><span class="Apple-converted-space">  </span>const tempDate = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));</p>
<p class="p1"><span class="Apple-converted-space">  </span>const dayNum = tempDate.getUTCDay() || 7;</p>
<p class="p1"><span class="Apple-converted-space">  </span>tempDate.setUTCDate(tempDate.getUTCDate() + 4 - dayNum);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const yearStart = new Date(Date.UTC(tempDate.getUTCFullYear(), 0, 1));</p>
<p class="p1"><span class="Apple-converted-space">  </span>const weekNo = Math.ceil((((tempDate.getTime() - yearStart.getTime()) / 86400000) + 1) / 7);</p>
<p class="p1"><span class="Apple-converted-space">  </span>return weekNo;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function formatDateRange(start: Date, end: Date) {</p>
<p class="p1"><span class="Apple-converted-space">  </span>return `${start.toLocaleDateString("de-DE")} – ${end.toLocaleDateString("de-DE")}`;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">export default function MikrobiomApp() {</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [currentDate, setCurrentDate] = useState(new Date());</p>
<p class="p1"><span class="Apple-converted-space">  </span>const currentWeek = getWeekRangeFromDate(currentDate);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const weekKey = currentWeek.start.toISOString().split("T")[0];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const [input, setInput] = useState("");</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [history, setHistory] = useState&lt;string[]&gt;([]);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [weeks, setWeeks] = useState&lt;{ [key: string]: string[] }&gt;(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const stored = localStorage.getItem("mikrobiom-weeks");</p>
<p class="p1"><span class="Apple-converted-space">    </span>return stored ? JSON.parse(stored) : {};</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const entries = weeks[weekKey] || [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const suggestionsFiltered = SUGGESTIONS.filter((item) =&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>item.toLowerCase().includes(input.toLowerCase()) &amp;&amp; !entries.includes(item)</p>
<p class="p1"><span class="Apple-converted-space">  </span>);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const handleAdd = (text: string) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const items = text</p>
<p class="p1"><span class="Apple-converted-space">      </span>.split(",")</p>
<p class="p1"><span class="Apple-converted-space">      </span>.map((i) =&gt; i.trim())</p>
<p class="p1"><span class="Apple-converted-space">      </span>.filter((i) =&gt; i.length &gt; 0 &amp;&amp; !entries.includes(i));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>if (items.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const updated = [...entries, ...items];</p>
<p class="p1"><span class="Apple-converted-space">      </span>setWeeks({ ...weeks, [weekKey]: updated });</p>
<p class="p1"><span class="Apple-converted-space">      </span>setHistory([</p>
<p class="p1"><span class="Apple-converted-space">        </span>...items,</p>
<p class="p1"><span class="Apple-converted-space">        </span>...history.filter((h) =&gt; !items.includes(h))</p>
<p class="p1"><span class="Apple-converted-space">      </span>].slice(0, 20));</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>setInput("");</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const handleDelete = (item: string) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const updated = entries.filter((e) =&gt; e !== item);</p>
<p class="p1"><span class="Apple-converted-space">    </span>setWeeks({ ...weeks, [weekKey]: updated });</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>let message = "";</p>
<p class="p1"><span class="Apple-converted-space">  </span>if (entries.length &gt;= 30) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>message = "Perfekt, dein Darm wird es dir danken.";</p>
<p class="p1"><span class="Apple-converted-space">  </span>} else if (entries.length &gt;= 25) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>message = "Das ist eine großartige Leistung, nur noch 5 Sorten.";</p>
<p class="p1"><span class="Apple-converted-space">  </span>} else if (entries.length &gt;= 15) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>message = "Super, du bist auf einem guten Weg.";</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const allWeeks = Object.entries(weeks);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const bestWeeks = allWeeks</p>
<p class="p1"><span class="Apple-converted-space">    </span>.sort((a, b) =&gt; b[1].length - a[1].length)</p>
<p class="p1"><span class="Apple-converted-space">    </span>.slice(0, 3);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>return (</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div className="max-w-xl mx-auto p-6 bg-pink-50 rounded-2xl shadow-lg mt-10"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;h1 className="text-3xl font-bold mb-4 text-rose-600"&gt;Dein Mikrobiom-Tracker&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="flex justify-between items-center mb-4"&gt;</p>
<p class="p2"><span class="Apple-converted-space">       </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button</p>
<p class="p1"><span class="Apple-converted-space">          </span>onClick={() =&gt; setCurrentDate(new Date(currentDate.setDate(currentDate.getDate() - 7)))}</p>
<p class="p1"><span class="Apple-converted-space">          </span>className="text-sm text-rose-600 hover:underline"</p>
<p class="p1"><span class="Apple-converted-space">        </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>◀ Vorige Woche</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;span className="text-sm text-grey-600 font-bold"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>KW {getCalendarWeek(currentWeek.start)}: {formatDateRange(currentWeek.start, currentWeek.end)}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button</p>
<p class="p1"><span class="Apple-converted-space">          </span>onClick={() =&gt; setCurrentDate(new Date(currentDate.setDate(currentDate.getDate() + 7)))}</p>
<p class="p1"><span class="Apple-converted-space">          </span>className="text-sm text-rose-600 hover:underline"</p>
<p class="p1"><span class="Apple-converted-space">        </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>Nächste Woche ▶</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;p className="text-sm text-gray-600 mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>Iss bis zu 30 verschiedene Obst- und Gemüsesorten pro Woche für eine gesunde Darmflora. Wie viele schaffst du diese Woche?</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/p&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="relative mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;Input</p>
<p class="p1"><span class="Apple-converted-space">          </span>value={input}</p>
<p class="p1"><span class="Apple-converted-space">          </span>onChange={(e) =&gt; setInput(e.target.value)}</p>
<p class="p1"><span class="Apple-converted-space">          </span>onKeyDown={(e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (e.key === "Enter") handleAdd(input);</p>
<p class="p1"><span class="Apple-converted-space">          </span>}}</p>
<p class="p1"><span class="Apple-converted-space">          </span>placeholder="z. B. Apfel, Brokkoli, ..."</p>
<p class="p1"><span class="Apple-converted-space">        </span>/&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>{input &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="absolute bg-white border rounded mt-1 w-full z-10"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>{suggestionsFiltered.slice(0, 5).map((s, i) =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div</p>
<p class="p1"><span class="Apple-converted-space">                </span>key={i}</p>
<p class="p1"><span class="Apple-converted-space">                </span>className="px-2 py-1 hover:bg-gray-100 cursor-pointer"</p>
<p class="p1"><span class="Apple-converted-space">                </span>onClick={() =&gt; handleAdd(s)}</p>
<p class="p1"><span class="Apple-converted-space">              </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>{s}</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>))}</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>)}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;Card&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;CardContent className="flex flex-wrap gap-2 p-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>{entries.map((item, i) =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div key={i} className="flex items-center gap-2 bg-rose-100 text-rose-600 px-3 py-1 rounded-full"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;span&gt;{item}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;button onClick={() =&gt; handleDelete(item)}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;X className="w-4 h-4" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>))}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/CardContent&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/Card&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;p className="mt-4 text-sm text-gray-600"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>{entries.length} von 30 Sorten eingetragen</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/p&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{message &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;p className="mt-3 text-base font-medium text-green-700 flex items-center gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;Sparkles className="w-5 h-5 animate-pulse" /&gt; {message}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>)}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="mt-10"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h2 className="text-xl font-semibold text-rose-600 mb-2"&gt;Dein Wochenüberblick&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;ul className="text-sm text-gray-600 list-disc list-inside"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>{allWeeks.slice(-4).map(([key, list]) =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;li key={key}&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>KW {getCalendarWeek(new Date(key))}: {list.length} Sorten</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>))}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/ul&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h2 className="text-xl font-semibold text-rose-600 mt-6 mb-2"&gt;Deine Top-3-Wochen&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;ol className="text-sm text-gray-600 list-decimal list-inside"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>{bestWeeks.map(([key, list]) =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;li key={key}&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>KW {new Date(key).toLocaleDateString("de-DE", { week: 'numeric' })}: {list.length} Sorten</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>))}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/ol&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>);</p>
<p class="p1">}</p>
</body>
</html>
